# Development Environment Configuration
# Optimized for cost and development workflows

# General Configuration
aws_region   = "us-east-1"
project_name = "feedbackhub"
environment  = "dev"

# Network Configuration (Smaller CIDR for dev)
vpc_cidr                = "10.1.0.0/16"
availability_zones_count = 2  # Reduced for cost
enable_vpc_flow_logs    = false # Disabled for cost

# EKS Cluster Configuration
cluster_version                      = "1.29"
cluster_endpoint_public_access       = true
cluster_endpoint_private_access      = true
cluster_endpoint_public_access_cidrs = ["0.0.0.0/0"]
cluster_enabled_log_types           = ["api", "audit"]  # Minimal logging for cost
cloudwatch_log_retention_days       = 7

# Security (Minimal for dev)
enable_cluster_encryption    = false
create_cluster_kms_key      = false
enable_node_group_encryption = false

# Node Group Configuration (Smaller instances)
node_group_instance_types = ["t3.small"]  # Smaller for dev
node_group_ami_type      = "AL2_x86_64"
node_group_capacity_type = "ON_DEMAND"
node_group_disk_size     = 30  # Smaller disk
node_group_min_size      = 1
node_group_max_size      = 3
node_group_desired_size  = 1   # Start with 1 node

# Spot Instances (Aggressive cost optimization)
enable_spot_instances = true
spot_instance_types   = ["t3.small", "t3.medium"]
spot_min_size        = 0
spot_max_size        = 5
spot_desired_size    = 1

# Additional Features
enable_fargate     = false
enable_efs_csi     = false
external_dns_enabled = false

# ALB Controller
alb_controller_chart_version = "1.6.2"
alb_controller_replica_count = 1  # Single replica for dev
enable_aws_shield           = false
enable_aws_waf              = false

# Monitoring Stack (Reduced resources)
enable_monitoring          = true
monitoring_namespace       = "monitoring"
monitoring_chart_version   = "55.5.0"
grafana_admin_password     = "admin"
prometheus_storage_size    = "10Gi"  # Smaller storage
grafana_storage_size       = "5Gi"
prometheus_replicas        = 1
alertmanager_replicas      = 1
enable_thanos             = false

# Monitoring Ingress (Disabled for dev)
prometheus_ingress_enabled = false
grafana_ingress_enabled    = false
enable_tls                = false

# Logging Stack (Minimal)
enable_logging             = true
logging_namespace          = "logging"
log_collector             = "promtail"
loki_storage_size         = "5Gi"   # Smaller storage
enable_cloudwatch_logging = false   # Disabled for cost
cloudwatch_retention_days = 7

# Logging Ingress (Disabled for dev)
enable_loki_gateway           = false
loki_gateway_ingress_enabled  = false

# Default Tags
default_tags = {
  Project     = "feedbackhub"
  Environment = "dev"
  ManagedBy   = "terraform"
  Owner       = "development-team"
  CostCenter  = "engineering"
  AutoShutdown = "true"  # For cost optimization scripts
}

# ALB Controller Resources (Reduced)
alb_controller_resources = {
  requests = {
    cpu    = "50m"
    memory = "64Mi"
  }
  limits = {
    cpu    = "100m"
    memory = "128Mi"
  }
}

# Ingress Annotations (Basic ALB)
ingress_annotations = {
  "kubernetes.io/ingress.class"                = "alb"
  "alb.ingress.kubernetes.io/scheme"           = "internet-facing"
  "alb.ingress.kubernetes.io/target-type"     = "ip"
}
